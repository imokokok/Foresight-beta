# 🔐 安全政策

> Foresight 协议的安全指南、漏洞报告流程和最佳实践。

---

## 📋 目录

- [支持的版本](#支持的版本)
- [报告漏洞](#报告漏洞)
- [安全响应流程](#安全响应流程)
- [安全最佳实践](#安全最佳实践)
- [智能合约安全](#智能合约安全)
- [漏洞奖励计划](#漏洞奖励计划)

---

## 支持的版本

我们会对以下版本提供安全更新：

| 版本           | 支持状态      |
| -------------- | ------------- |
| 最新版         | ✅ 支持       |
| 上一个主要版本 | ⚠️ 仅安全更新 |
| 更早版本       | ❌ 不支持     |

---

## 报告漏洞

### ⚠️ 请勿公开披露

在问题被修复之前，**请勿**在公开渠道（GitHub Issues、Discord、Twitter 等）讨论安全漏洞。

### 📧 报告方式

请通过以下方式报告安全漏洞：

**Email**: [security@foresight.market](mailto:security@foresight.market)

### 报告内容

请在报告中包含以下信息：

1. **漏洞描述**：清晰描述漏洞的性质
2. **影响范围**：受影响的组件/功能
3. **复现步骤**：详细的复现步骤
4. **概念验证**：PoC 代码或截图（如有）
5. **严重程度评估**：你对漏洞严重程度的评估
6. **建议修复方案**：如果有的话

### 报告模板

```markdown
## 漏洞描述

[简要描述漏洞]

## 影响范围

- 组件: [例如: 智能合约/前端/API]
- 版本: [受影响的版本]
- 严重程度: [Critical/High/Medium/Low]

## 复现步骤

1. [步骤 1]
2. [步骤 2]
3. ...

## 概念验证

[PoC 代码或详细说明]

## 潜在影响

[描述可能的攻击场景和影响]

## 建议修复方案

[如果有的话]
```

---

## 安全响应流程

### 响应时间

| 阶段     | 时间目标     |
| -------- | ------------ |
| 初次响应 | 24 小时内    |
| 漏洞确认 | 72 小时内    |
| 修复计划 | 7 天内       |
| 发布修复 | 根据严重程度 |

### 严重程度定义

| 级别         | 描述             | 修复时间   |
| ------------ | ---------------- | ---------- |
| **Critical** | 可能导致资金损失 | 24-48 小时 |
| **High**     | 严重功能受损     | 7 天内     |
| **Medium**   | 中等影响         | 30 天内    |
| **Low**      | 轻微问题         | 下个版本   |

### 处理流程

```
1. 收到报告
   ↓
2. 确认收到 (24h)
   ↓
3. 漏洞验证 (72h)
   ↓
4. 评估严重程度
   ↓
5. 制定修复计划
   ↓
6. 开发修复补丁
   ↓
7. 内部安全审查
   ↓
8. 发布修复版本
   ↓
9. 公开披露 (协调后)
```

---

## 安全最佳实践

### 用户安全建议

#### 🔑 私钥安全

- **永远不要**分享你的私钥或助记词
- 使用硬件钱包存储大额资产
- 定期检查已授权的 DApp

#### 🌐 网络安全

- 只访问官方网站：[https://foresight.market](https://foresight.market)
- 验证 URL 和 SSL 证书
- 小心钓鱼网站和虚假社交账号

#### 💳 交易安全

- 交易前仔细检查交易详情
- 设置合理的滑点保护
- 使用小额测试大额操作

### 开发者安全建议

#### 环境变量

```bash
# ✅ 正确做法
cp .env.example .env.local
# 编辑 .env.local

# ❌ 错误做法
# 永远不要将 .env.local 提交到 Git
```

#### 依赖管理

```bash
# 定期检查依赖漏洞
npm audit

# 更新有漏洞的依赖
npm audit fix
```

---

## 智能合约安全

### 已实施的安全措施

#### 访问控制

- ✅ OpenZeppelin AccessControl
- ✅ 多签钱包 (Gnosis Safe)
- ✅ 24 小时 Timelock

#### 重入保护

- ✅ ReentrancyGuard 所有外部调用
- ✅ Checks-Effects-Interactions 模式

#### 签名安全

- ✅ EIP-712 结构化签名
- ✅ ECDSA 可延展性保护
- ✅ 订单 salt 唯一性检查

#### 经济安全

- ✅ 闪电贷攻击防护（单区块限额）
- ✅ 批量操作大小限制
- ✅ 最小订单生命周期

#### 紧急措施

- ✅ 熔断机制（紧急暂停）
- ✅ 分级权限系统

### 审计状态

| 合约                 | 审计状态  | 审计方 |
| -------------------- | --------- | ------ |
| MarketFactory        | 🔄 准备中 | -      |
| OffchainBinaryMarket | 🔄 准备中 | -      |
| OffchainMultiMarket8 | 🔄 准备中 | -      |
| OutcomeToken1155     | 🔄 准备中 | -      |
| UMAOracleAdapterV2   | 🔄 准备中 | -      |

### 已知限制

1. **预言机依赖**：市场结算依赖 UMA 预言机
2. **管理员权限**：多签可以暂停合约和升级实现
3. **Timelock 延迟**：紧急情况下需要等待 24 小时

---

## 漏洞奖励计划

我们正在筹备正式的漏洞奖励计划。在此之前，有效的安全报告将根据严重程度获得以下奖励：

| 严重程度 | 奖励范围         |
| -------- | ---------------- |
| Critical | $5,000 - $20,000 |
| High     | $2,000 - $5,000  |
| Medium   | $500 - $2,000    |
| Low      | $100 - $500      |

### 奖励条件

- ✅ 首次报告该漏洞
- ✅ 提供有效的复现步骤
- ✅ 遵循负责任披露流程
- ✅ 未造成实际损失

### 排除范围

以下情况不在奖励范围内：

- ❌ 已知问题或已报告的漏洞
- ❌ 社会工程学攻击
- ❌ 物理攻击
- ❌ DoS 攻击（除非有特殊影响）
- ❌ 第三方服务的漏洞
- ❌ 测试网上的问题

---

## 联系方式

- **安全问题**: [security@foresight.market](mailto:security@foresight.market)
- **一般咨询**: [hello@foresight.market](mailto:hello@foresight.market)
- **Discord**: [Foresight Community](https://discord.gg/foresight)

---

感谢你帮助我们保护 Foresight 生态系统的安全！🛡️

---

**语言切换 / Languages:**

- [🇺🇸 SECURITY.md](./SECURITY.md) - English
- [🇨🇳 SECURITY.zh-CN.md](./SECURITY.zh-CN.md) - 简体中文
