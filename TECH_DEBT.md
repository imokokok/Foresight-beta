# 技术债务清单

本文档记录 Foresight 项目中已识别的技术债务，用于追踪和规划偿还工作。

## 更新日期

2024-01-24

## 高优先级（需在下一季度内解决）

### 1. 错误处理不一致

**描述**：项目中错误处理方式不统一，部分使用 try-catch，部分直接抛出，可能导致错误状态丢失。

**影响**：降低系统可靠性，增加问题排查难度。

**位置**：
- `services/relayer/src/matching/matchingEngine.ts`
- `services/relayer/src/settlement/batchSettler.ts`
- 多处 API 路由

**状态**：进行中
**负责人**：后端团队

### 2. 类型安全问题

**描述**：部分文件使用 `any` 类型绕过 TypeScript 检查，削弱类型系统保护。

**影响**：运行时错误风险增加，IDE 支持减弱。

**位置**：
- `apps/web/src/contexts/AuthContext.tsx`（已修复）
- 多个 API 响应类型定义缺失

**状态**：进行中
**负责人**：全栈团队

### 3. 安全审计缺失

**描述**：涉及资金处理的代码（Relayer 服务的 settlement、matching 模块）缺少专业安全审计。

**影响**：潜在安全漏洞可能导致资金损失。

**状态**：待开始
**负责人**：安全团队

---

## 中优先级（需在半年内解决）

### 4. AuthContext 职责过重

**描述**：`AuthContext` 混合了认证、钱包连接、用户数据管理等多重职责。

**影响**：代码复杂度高，难以单独测试和维护。

**状态**：待开始
**负责人**：前端团队

### 5. 缺少 E2E 测试

**描述**：目前仅有单元测试和集成测试，缺少端到端测试验证完整用户流程。

**影响**：端到端功能验证不足，可能遗漏关键问题。

**状态**：进行中
**负责人**：QA 团队

### 6. 依赖更新策略缺失

**描述**：没有自动化依赖安全更新机制，安全漏洞修复可能延迟。

**影响**：安全合规风险。

**状态**：已完成（Dependabot）
**负责人**：DevOps 团队

### 7. API 文档缺失

**描述**：缺少 OpenAPI/Swagger 格式的 API 文档。

**影响**：前后端协作效率低，API 变更难以追踪。

**状态**：待开始
**负责人**：后端团队

---

## 低优先级（可在一年内解决）

### 8. 共享代码库不完整

**描述**：前端和后端存在重复的类型定义和工具函数。

**影响**：代码重复，维护成本增加。

**状态**：进行中（packages/shared 已创建）
**负责人**：全栈团队

### 9. 日志级别管理

**描述**：生产环境日志量可能过多或过少，缺乏统一日志级别管理。

**影响**：问题排查效率低。

**状态**：待开始
**负责人**：后端团队

### 10. 性能监控覆盖不全

**描述**：部分模块缺少性能指标监控。

**影响**：难以发现性能瓶颈。

**状态**：待开始
**负责人**：后端团队

### 11. 缺少 API 版本控制

**描述**：当前 API 缺少版本控制机制。

**影响**：未来 API 变更可能破坏现有客户端。

**状态**：待开始
**负责人**：后端团队

### 12. 架构决策记录（ADR）不完整

**描述**：部分重要技术决策缺少 ADR 记录。

**影响**：新成员难以理解项目背景。

**状态**：进行中
**负责人**：技术负责人

---

## 已解决的技术债务

| 编号 | 描述 | 解决日期 |
|------|------|----------|
| - | 创建共享类型包 packages/shared | 2024-01-24 |
| - | 集成 Dependabot 自动化依赖更新 | 2024-01-24 |
| - | 建立统一错误处理机制 | 2024-01-24 |
| - | 修复 AuthContext 中的 any 类型 | 2024-01-24 |

---

## 偿还策略

1. **高优先级**：每个 Sprint 预留 20% 时间偿还
2. **中优先级**：每个季度集中处理一批
3. **低优先级**：根据实际遇到的问题优先级处理

## 评估周期

每月进行一次技术债务评估，更新清单和优先级。
